(()=>{"use strict";const e=class{constructor(e,t){this.errorHandler=e=>{if(!e.ok)throw 401!==e.status&&404!==e.status||console.log(`Sorry, but there is ${e.status} error: ${e.statusText}`),Error(e.statusText);return e},this.baseLink=e,this.options=t}getResp({endpoint:e="",options:t={}},s){this.load("GET",e,s,t)}makeUrl(e,t){const s={...this.options,...e};let r=`${this.baseLink}${t}?`;return Object.keys(s).forEach((e=>{r+=`${e}=${s[e]}&`})),r.slice(0,-1)}load(e,t,s,r={}){fetch(this.makeUrl(r,t),{method:e}).then(this.errorHandler).then((e=>e.json())).then((e=>s(e))).catch((e=>console.error(e)))}};const t=class extends e{constructor(){super("https://nodenews.herokuapp.com/",{apiKey:"c49d25c9f6de4b27b30b25eedb63391e"})}};const s=class extends t{getSources(e){super.getResp({endpoint:"sources"},e)}getNews(e,t){let s=e.target;const r=e.currentTarget;for(;s!==r;){if(s.classList.contains("source__item")){const e=s.getAttribute("data-source-id");return void(r.getAttribute("data-source")!==e&&(r.setAttribute("data-source",e),super.getResp({endpoint:"everything",options:{sources:e}},t)))}s=s.parentNode}}};const r=class{draw(e){const t=e.length>=10?e.filter(((e,t)=>t<10)):e,s=document.createDocumentFragment(),r=document.querySelector("#newsItemTemp");t.forEach(((e,t)=>{const o=r.content.cloneNode(!0);t%2&&o.querySelector(".news__item").classList.add("alt");o.querySelector(".news__meta-photo").style.backgroundImage=`\n        url(${e.urlToImage||"img/news_placeholder.jpg"})\n      `,o.querySelector(".news__meta-author").textContent=e.author||e.source.name,o.querySelector(".news__meta-date").textContent=e.publishedAt.slice(0,10).split("-").reverse().join("-"),o.querySelector(".news__description-title").textContent=e.title,o.querySelector(".news__description-source").textContent=e.source.name,o.querySelector(".news__description-content").textContent=e.description,o.querySelector(".news__read-more a").setAttribute("href",e.url),s.append(o)})),document.querySelector(".news").innerHTML="",document.querySelector(".news").appendChild(s)}};const o=class{draw(e){const t=document.createDocumentFragment(),s=document.querySelector("#sourceItemTemp");e.forEach((e=>{const r=s.content.cloneNode(!0);r.querySelector(".source__item-name").textContent=e.name,r.querySelector(".source__item").setAttribute("data-source-id",e.id),t.append(r)})),document.querySelector(".sources").append(t)}};class n{constructor(){this.news=new r,this.sources=new o}drawNews(e){const t=e?.articles?e?.articles:[];this.news.draw(t)}drawSources(e){const t=e?.sources?e?.sources:[];this.sources.draw(t)}}(new class{constructor(){this.controller=new s,this.view=new n}start(){document.querySelector(".sources").addEventListener("click",(e=>this.controller.getNews(e,(e=>this.view.drawNews(e))))),this.controller.getSources((e=>this.view.drawSources(e)))}}).start()})();